title = "Gitleaks rules for Bank App"

# ===============================================
# ALLOWLIST (IGNORAR ARQUIVOS E REGRAS)
# ===============================================

[allowlist]
paths = [
  # Ignora o arquivo de baseline do detect-secrets.
  # Essencial para evitar falsos positivos nos segredos já conhecidos.
  "\\.secrets\\.baseline",
]

# Se você quiser ignorar uma regra default do Gitleaks, use:
# rules = [
#   "generic-api-key", 
# ]
# NOTA: O Gitleaks já ignora o generic-api-key se estiver em .secrets.baseline.

# ===============================================
# REGRAS CUSTOMIZADAS (Necessário ID para v8.x)
# ===============================================

[[rules]]
id = "custom-aws-access-key-id" # ID Único
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws","key"]

[[rules]]
id = "custom-aws-secret-access-key" # ID Único
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(secret|secret_key|secretaccesskey).{0,60}['"|=:\s]([A-Za-z0-9/+=]{40})'''
tags = ["aws","secret"]

[[rules]]
id = "custom-google-service-account" # ID Único
description = "Google Service Account"
regex = '''"type":\s*"service_account"'''
tags = ["gcp","service-account"]

[[rules]]
id = "custom-private-key-pem" # ID Único
description = "Private key"
regex = '''-----BEGIN (RSA|PRIVATE|EC) PRIVATE KEY-----'''
tags = ["private-key","pem"]

[[rules]]
id = "custom-jwt-token" # ID Único (Era o que estava faltando!)
description = "JWT (long base64 token)"
regex = '''eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_.-]{10,}\.[A-Za-z0-9_.-]{10,}'''
tags = ["jwt","token"]